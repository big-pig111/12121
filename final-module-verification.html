<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æœ€ç»ˆæ¨¡å—éªŒè¯å·¥å…·</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }
        
        .container {
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
        }
        
        h1 {
            text-align: center;
            color: #4a5568;
            margin-bottom: 30px;
            font-size: 2.5em;
        }
        
        .status-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .module-card {
            background: #f7fafc;
            border: 2px solid #e2e8f0;
            border-radius: 10px;
            padding: 20px;
            transition: all 0.3s ease;
        }
        
        .module-card.success {
            border-color: #48bb78;
            background: #f0fff4;
        }
        
        .module-card.error {
            border-color: #f56565;
            background: #fff5f5;
        }
        
        .module-card.loading {
            border-color: #ed8936;
            background: #fffaf0;
        }
        
        .module-name {
            font-weight: bold;
            font-size: 1.2em;
            margin-bottom: 10px;
            color: #2d3748;
        }
        
        .module-status {
            font-size: 0.9em;
            margin-bottom: 5px;
        }
        
        .module-details {
            font-size: 0.8em;
            color: #718096;
            margin-top: 10px;
        }
        
        .test-section {
            background: #edf2f7;
            border-radius: 10px;
            padding: 20px;
            margin-top: 20px;
        }
        
        .test-section h3 {
            color: #2d3748;
            margin-bottom: 15px;
        }
        
        .test-button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1em;
            margin: 5px;
            transition: all 0.3s ease;
        }
        
        .test-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }
        
        .test-button:disabled {
            background: #cbd5e0;
            cursor: not-allowed;
            transform: none;
        }
        
        .result-area {
            background: #2d3748;
            color: #e2e8f0;
            padding: 15px;
            border-radius: 8px;
            margin-top: 15px;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
            max-height: 300px;
            overflow-y: auto;
            white-space: pre-wrap;
        }
        
        .summary {
            background: #e6fffa;
            border: 2px solid #4fd1c7;
            border-radius: 10px;
            padding: 20px;
            margin-top: 20px;
        }
        
        .summary h3 {
            color: #2c7a7b;
            margin-bottom: 15px;
        }
        
        .summary-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
            padding: 5px 0;
            border-bottom: 1px solid #b2f5ea;
        }
        
        .summary-label {
            font-weight: bold;
            color: #2c7a7b;
        }
        
        .summary-value {
            color: #319795;
        }
        
        .success-text {
            color: #38a169;
        }
        
        .error-text {
            color: #e53e3e;
        }
        
        .warning-text {
            color: #d69e2e;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ”§ æœ€ç»ˆæ¨¡å—éªŒè¯å·¥å…·</h1>
        
        <div class="status-grid" id="moduleGrid">
            <!-- æ¨¡å—çŠ¶æ€å°†åœ¨è¿™é‡ŒåŠ¨æ€ç”Ÿæˆ -->
        </div>
        
        <div class="test-section">
            <h3>ğŸ§ª åŠŸèƒ½æµ‹è¯•</h3>
            <button class="test-button" onclick="testAllModules()">æµ‹è¯•æ‰€æœ‰æ¨¡å—</button>
            <button class="test-button" onclick="testTransactionDetection()">æµ‹è¯•äº¤æ˜“æ£€æµ‹</button>
            <button class="test-button" onclick="testAppInitialization()">æµ‹è¯•åº”ç”¨åˆå§‹åŒ–</button>
            <button class="test-button" onclick="clearResults()">æ¸…é™¤ç»“æœ</button>
            
            <div class="result-area" id="testResults">
                ç‚¹å‡»ä¸Šæ–¹æŒ‰é’®å¼€å§‹æµ‹è¯•...
            </div>
        </div>
        
        <div class="summary" id="summary">
            <h3>ğŸ“Š æµ‹è¯•æ€»ç»“</h3>
            <div class="summary-item">
                <span class="summary-label">æ€»æ¨¡å—æ•°:</span>
                <span class="summary-value" id="totalModules">-</span>
            </div>
            <div class="summary-item">
                <span class="summary-label">æˆåŠŸåŠ è½½:</span>
                <span class="summary-value success-text" id="successModules">-</span>
            </div>
            <div class="summary-item">
                <span class="summary-label">åŠ è½½å¤±è´¥:</span>
                <span class="summary-value error-text" id="failedModules">-</span>
            </div>
            <div class="summary-item">
                <span class="summary-label">åº”ç”¨çŠ¶æ€:</span>
                <span class="summary-value" id="appStatus">-</span>
            </div>
        </div>
    </div>

    <script>
        // æ¨¡å—åˆ—è¡¨
        const modules = [
            'Utils',
            'CountdownManager', 
            'TransactionTracker',
            'UIEffects',
            'BackendManager',
            'TokenHoldersManager',
            'WalletManager',
            'WhitepaperModal',
            'ClaimRewardModal',
            'MemeCoinApp'
        ];
        
        let testResults = [];
        
        // åˆå§‹åŒ–é¡µé¢
        document.addEventListener('DOMContentLoaded', () => {
            updateModuleGrid();
            updateSummary();
        });
        
        // æ›´æ–°æ¨¡å—çŠ¶æ€ç½‘æ ¼
        function updateModuleGrid() {
            const grid = document.getElementById('moduleGrid');
            grid.innerHTML = '';
            
            modules.forEach(moduleName => {
                const card = document.createElement('div');
                card.className = 'module-card';
                
                const isLoaded = typeof window[moduleName] !== 'undefined';
                const status = isLoaded ? 'success' : 'error';
                const statusText = isLoaded ? 'âœ… å·²åŠ è½½' : 'âŒ æœªåŠ è½½';
                
                card.classList.add(status);
                
                card.innerHTML = `
                    <div class="module-name">${moduleName}</div>
                    <div class="module-status">${statusText}</div>
                    <div class="module-details">
                        å…¨å±€å¯¹è±¡: ${isLoaded ? 'window.' + moduleName : 'undefined'}<br>
                        ç±»å‹: ${isLoaded ? typeof window[moduleName] : 'N/A'}
                    </div>
                `;
                
                grid.appendChild(card);
            });
        }
        
        // æ›´æ–°æ€»ç»“
        function updateSummary() {
            const totalModules = modules.length;
            const successModules = modules.filter(name => typeof window[name] !== 'undefined').length;
            const failedModules = totalModules - successModules;
            
            document.getElementById('totalModules').textContent = totalModules;
            document.getElementById('successModules').textContent = successModules;
            document.getElementById('failedModules').textContent = failedModules;
            
            // æ£€æŸ¥åº”ç”¨çŠ¶æ€
            const appStatus = typeof window.memeCoinApp !== 'undefined' ? 
                'âœ… å·²åˆå§‹åŒ–' : 'âŒ æœªåˆå§‹åŒ–';
            document.getElementById('appStatus').textContent = appStatus;
        }
        
        // æµ‹è¯•æ‰€æœ‰æ¨¡å—
        function testAllModules() {
            clearResults();
            addResult('ğŸ§ª å¼€å§‹æµ‹è¯•æ‰€æœ‰æ¨¡å—...\n');
            
            let successCount = 0;
            let failCount = 0;
            
            modules.forEach(moduleName => {
                const isLoaded = typeof window[moduleName] !== 'undefined';
                
                if (isLoaded) {
                    addResult(`âœ… ${moduleName}: å·²åŠ è½½`);
                    successCount++;
                    
                    // å°è¯•å®ä¾‹åŒ–
                    try {
                        if (moduleName === 'MemeCoinApp') {
                            // MemeCoinApp å·²ç»åœ¨ DOMContentLoaded ä¸­å®ä¾‹åŒ–
                            addResult(`   â””â”€ åº”ç”¨å®ä¾‹: ${typeof window.memeCoinApp !== 'undefined' ? 'å·²åˆ›å»º' : 'æœªåˆ›å»º'}`);
                        } else {
                            const instance = new window[moduleName]();
                            addResult(`   â””â”€ å®ä¾‹åŒ–: æˆåŠŸ`);
                        }
                    } catch (error) {
                        addResult(`   â””â”€ å®ä¾‹åŒ–: å¤±è´¥ - ${error.message}`);
                        failCount++;
                    }
                } else {
                    addResult(`âŒ ${moduleName}: æœªåŠ è½½`);
                    failCount++;
                }
            });
            
            addResult(`\nğŸ“Š æµ‹è¯•ç»“æœ: ${successCount} æˆåŠŸ, ${failCount} å¤±è´¥`);
            updateModuleGrid();
            updateSummary();
        }
        
        // æµ‹è¯•äº¤æ˜“æ£€æµ‹
        function testTransactionDetection() {
            clearResults();
            addResult('ğŸ” æµ‹è¯•äº¤æ˜“æ£€æµ‹åŠŸèƒ½...\n');
            
            // æ£€æŸ¥æ£€æµ‹æ§åˆ¶é…ç½®
            const detectionConfig = localStorage.getItem('memeCoinDetection');
            addResult(`æ£€æµ‹æ§åˆ¶é…ç½®: ${detectionConfig || 'æœªè®¾ç½®'}`);
            
            if (detectionConfig) {
                try {
                    const config = JSON.parse(detectionConfig);
                    addResult(`  â””â”€ isRunning: ${config.isRunning}`);
                    addResult(`  â””â”€ tokenAddress: ${config.tokenAddress || 'æœªè®¾ç½®'}`);
                    addResult(`  â””â”€ rpcUrl: ${config.rpcUrl || 'æœªè®¾ç½®'}`);
                } catch (error) {
                    addResult(`  â””â”€ é…ç½®è§£æå¤±è´¥: ${error.message}`);
                }
            }
            
            // æ£€æŸ¥ TransactionTracker
            if (typeof window.TransactionTracker !== 'undefined') {
                addResult(`âœ… TransactionTracker: å·²åŠ è½½`);
                
                // æ£€æŸ¥ BackendManager
                if (typeof window.BackendManager !== 'undefined') {
                    addResult(`âœ… BackendManager: å·²åŠ è½½`);
                    
                    try {
                        const backend = new BackendManager();
                        const detectionControl = backend.getDetectionControl();
                        addResult(`  â””â”€ æ£€æµ‹æ§åˆ¶çŠ¶æ€: ${detectionControl ? JSON.stringify(detectionControl) : 'æœªè·å–åˆ°'}`);
                    } catch (error) {
                        addResult(`  â””â”€ BackendManager åˆå§‹åŒ–å¤±è´¥: ${error.message}`);
                    }
                } else {
                    addResult(`âŒ BackendManager: æœªåŠ è½½`);
                }
            } else {
                addResult(`âŒ TransactionTracker: æœªåŠ è½½`);
            }
            
            // æ£€æŸ¥åº”ç”¨å®ä¾‹
            if (typeof window.memeCoinApp !== 'undefined') {
                addResult(`âœ… MemeCoinApp: å·²åˆå§‹åŒ–`);
                
                const transactionModule = window.memeCoinApp.getTransactionTracker();
                if (transactionModule) {
                    addResult(`  â””â”€ äº¤æ˜“æ¨¡å—: å·²è·å–`);
                } else {
                    addResult(`  â””â”€ äº¤æ˜“æ¨¡å—: æœªè·å–`);
                }
            } else {
                addResult(`âŒ MemeCoinApp: æœªåˆå§‹åŒ–`);
            }
        }
        
        // æµ‹è¯•åº”ç”¨åˆå§‹åŒ–
        function testAppInitialization() {
            clearResults();
            addResult('ğŸš€ æµ‹è¯•åº”ç”¨åˆå§‹åŒ–...\n');
            
            if (typeof window.MemeCoinApp !== 'undefined') {
                addResult(`âœ… MemeCoinApp ç±»: å·²å®šä¹‰`);
                
                try {
                    // åˆ›å»ºæ–°çš„åº”ç”¨å®ä¾‹
                    const testApp = new window.MemeCoinApp();
                    addResult(`âœ… åº”ç”¨å®ä¾‹: åˆ›å»ºæˆåŠŸ`);
                    
                    // æ£€æŸ¥æ¨¡å—
                    const modules = testApp.modules;
                    addResult(`ğŸ“¦ æ¨¡å—çŠ¶æ€:`);
                    
                    Object.entries(modules).forEach(([name, module]) => {
                        const status = module ? 'âœ… å·²åˆå§‹åŒ–' : 'âŒ æœªåˆå§‹åŒ–';
                        addResult(`  â””â”€ ${name}: ${status}`);
                    });
                    
                    // æ¸…ç†æµ‹è¯•å®ä¾‹
                    if (typeof testApp.destroy === 'function') {
                        testApp.destroy();
                        addResult(`ğŸ§¹ æµ‹è¯•å®ä¾‹: å·²æ¸…ç†`);
                    }
                    
                } catch (error) {
                    addResult(`âŒ åº”ç”¨å®ä¾‹: åˆ›å»ºå¤±è´¥ - ${error.message}`);
                    addResult(`   é”™è¯¯å †æ ˆ: ${error.stack}`);
                }
            } else {
                addResult(`âŒ MemeCoinApp ç±»: æœªå®šä¹‰`);
            }
        }
        
        // æ·»åŠ æµ‹è¯•ç»“æœ
        function addResult(message) {
            testResults.push(message);
            document.getElementById('testResults').textContent = testResults.join('\n');
        }
        
        // æ¸…é™¤ç»“æœ
        function clearResults() {
            testResults = [];
            document.getElementById('testResults').textContent = 'ç‚¹å‡»ä¸Šæ–¹æŒ‰é’®å¼€å§‹æµ‹è¯•...';
        }
        
        // å®šæœŸæ›´æ–°çŠ¶æ€
        setInterval(() => {
            updateModuleGrid();
            updateSummary();
        }, 2000);
    </script>
</body>
</html> 