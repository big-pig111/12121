<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>åœ°å€æ•°æ®ç®¡ç†å™¨</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
            background: #f0f0f0;
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .section {
            margin-bottom: 30px;
            padding: 20px;
            border: 1px solid #ddd;
            border-radius: 8px;
        }
        .section h2 {
            margin-top: 0;
            color: #333;
            border-bottom: 2px solid #007bff;
            padding-bottom: 10px;
        }
        .address-item {
            background: #f8f9fa;
            padding: 15px;
            margin: 10px 0;
            border-radius: 5px;
            border-left: 4px solid #007bff;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .address-info {
            flex: 1;
        }
        .address-text {
            font-family: monospace;
            font-weight: bold;
            color: #333;
            margin-bottom: 5px;
        }
        .address-details {
            font-size: 0.9em;
            color: #666;
        }
        .delete-btn {
            background: #dc3545;
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 4px;
            cursor: pointer;
            margin-left: 10px;
        }
        .delete-btn:hover {
            background: #c82333;
        }
        .action-btn {
            background: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
            font-size: 14px;
        }
        .action-btn:hover {
            background: #0056b3;
        }
        .action-btn.danger {
            background: #dc3545;
        }
        .action-btn.danger:hover {
            background: #c82333;
        }
        .status {
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
        }
        .status.success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        .status.error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        .status.info {
            background: #d1ecf1;
            color: #0c5460;
            border: 1px solid #bee5eb;
        }
        .firebase-status {
            display: inline-block;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            margin-right: 8px;
        }
        .firebase-status.connected {
            background: #28a745;
        }
        .firebase-status.disconnected {
            background: #dc3545;
        }
        .firebase-status.unknown {
            background: #ffc107;
        }
        
        .data-section, .sync-section, .list-section {
            margin-bottom: 20px;
            padding: 15px;
            border: 1px solid #e9ecef;
            border-radius: 5px;
            background: #f8f9fa;
        }
        
        .data-section h3, .sync-section h3, .list-section h3 {
            margin-top: 0;
            margin-bottom: 10px;
            color: #495057;
            font-size: 1.1em;
        }
        
        .holder-item {
            background: #e3f2fd;
            padding: 12px;
            margin: 8px 0;
            border-radius: 5px;
            border-left: 4px solid #2196f3;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .holder-info {
            flex: 1;
        }
        
        .holder-rank {
            font-weight: bold;
            color: #1976d2;
            margin-bottom: 5px;
        }
        
        .holder-address {
            font-family: monospace;
            font-size: 0.9em;
            color: #333;
        }
        
        .holder-balance {
            font-size: 0.9em;
            color: #666;
            margin-top: 3px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ’° åœ°å€æ•°æ®ç®¡ç†å™¨</h1>
        <p>ç®¡ç†æˆåŠŸåœ°å€å’ŒæŒä»“åœ°å€çš„æ•°æ®</p>

        <!-- Firebase è¿æ¥çŠ¶æ€ -->
        <div class="section">
            <h2>ğŸŒ Firebase è¿æ¥çŠ¶æ€</h2>
            <div id="firebaseStatus" class="status info">
                <span class="firebase-status unknown"></span>
                æ­£åœ¨æ£€æŸ¥è¿æ¥çŠ¶æ€...
            </div>
            <button class="action-btn" onclick="checkFirebaseConnection()">æ£€æŸ¥è¿æ¥</button>
        </div>

        <!-- æˆåŠŸåœ°å€æ•°æ® -->
        <div class="section">
            <h2>ğŸ’° æˆåŠŸåœ°å€æ•°æ®ï¼ˆå¤§é¢ä¹°å…¥åœ°å€ï¼‰</h2>
            <div class="data-section">
                <h3>ğŸ’¾ æœ¬åœ°å­˜å‚¨</h3>
                <div id="successLocalData" class="status info">
                    æ­£åœ¨åŠ è½½æœ¬åœ°æ•°æ®...
                </div>
                <button class="action-btn" onclick="loadSuccessLocalData()">åˆ·æ–°æœ¬åœ°æ•°æ®</button>
                <button class="action-btn danger" onclick="clearSuccessLocalData()">æ¸…ç©ºæœ¬åœ°æ•°æ®</button>
            </div>
            <div class="data-section">
                <h3>ğŸ”¥ Firebase æ•°æ®åº“</h3>
                <div id="successFirebaseData" class="status info">
                    æ­£åœ¨åŠ è½½ Firebase æ•°æ®...
                </div>
                <button class="action-btn" onclick="loadSuccessFirebaseData()">åˆ·æ–° Firebase æ•°æ®</button>
                <button class="action-btn danger" onclick="clearSuccessFirebaseData()">æ¸…ç©º Firebase æ•°æ®</button>
            </div>
        </div>

        <!-- æŒä»“åœ°å€æ•°æ® -->
        <div class="section">
            <h2>ğŸ† æŒä»“åœ°å€æ•°æ®ï¼ˆTop 20 æŒæœ‰è€…ï¼‰</h2>
            <div class="data-section">
                <h3>ğŸ’¾ æœ¬åœ°å­˜å‚¨</h3>
                <div id="holdersLocalData" class="status info">
                    æ­£åœ¨åŠ è½½æœ¬åœ°æ•°æ®...
                </div>
                <button class="action-btn" onclick="loadHoldersLocalData()">åˆ·æ–°æœ¬åœ°æ•°æ®</button>
                <button class="action-btn danger" onclick="clearHoldersLocalData()">æ¸…ç©ºæœ¬åœ°æ•°æ®</button>
            </div>
            <div class="data-section">
                <h3>ğŸ”¥ Firebase æ•°æ®åº“</h3>
                <div id="holdersFirebaseData" class="status info">
                    æ­£åœ¨åŠ è½½ Firebase æ•°æ®...
                </div>
                <button class="action-btn" onclick="loadHoldersFirebaseData()">åˆ·æ–° Firebase æ•°æ®</button>
                <button class="action-btn danger" onclick="clearHoldersFirebaseData()">æ¸…ç©º Firebase æ•°æ®</button>
            </div>
        </div>

        <!-- æ•°æ®åŒæ­¥ -->
        <div class="section">
            <h2>ğŸ”„ æ•°æ®åŒæ­¥</h2>
            <div class="sync-section">
                <h3>ğŸ’° æˆåŠŸåœ°å€åŒæ­¥</h3>
                <button class="action-btn" onclick="syncSuccessLocalToFirebase()">æœ¬åœ° â†’ Firebase</button>
                <button class="action-btn" onclick="syncSuccessFirebaseToLocal()">Firebase â†’ æœ¬åœ°</button>
            </div>
            <div class="sync-section">
                <h3>ğŸ† æŒä»“åœ°å€åŒæ­¥</h3>
                <button class="action-btn" onclick="syncHoldersLocalToFirebase()">æœ¬åœ° â†’ Firebase</button>
                <button class="action-btn" onclick="syncHoldersFirebaseToLocal()">Firebase â†’ æœ¬åœ°</button>
            </div>
            <div class="sync-section">
                <h3>ğŸ”„ å…¨éƒ¨åŒæ­¥</h3>
                <button class="action-btn" onclick="syncAllData()">åŒæ­¥æ‰€æœ‰æ•°æ®</button>
            </div>
        </div>

        <!-- åœ°å€åˆ—è¡¨ -->
        <div class="section">
            <h2>ğŸ“‹ åœ°å€åˆ—è¡¨</h2>
            <div class="list-section">
                <h3>ğŸ’° æˆåŠŸåœ°å€åˆ—è¡¨</h3>
                <div id="successAddressList">
                    æ­£åœ¨åŠ è½½æˆåŠŸåœ°å€åˆ—è¡¨...
                </div>
            </div>
            <div class="list-section">
                <h3>ğŸ† æŒä»“åœ°å€åˆ—è¡¨</h3>
                <div id="holdersAddressList">
                    æ­£åœ¨åŠ è½½æŒä»“åœ°å€åˆ—è¡¨...
                </div>
            </div>
        </div>
    </div>

    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>

    <script>
        // Firebase é…ç½®
        const firebaseConfig = {
            apiKey: "AIzaSyA5Z5ieEbAcfQX0kxGSn9ldGXhzvAwx_8M",
            authDomain: "chat-294cc.firebaseapp.com",
            databaseURL: "https://chat-294cc-default-rtdb.firebaseio.com",
            projectId: "chat-294cc",
            storageBucket: "chat-294cc.firebasestorage.app",
            messagingSenderId: "913615304269",
            appId: "1:913615304269:web:0274ffaccb8e6b678e4e04",
            measurementId: "G-SJR9NDW86B"
        };

        // åˆå§‹åŒ– Firebase
        firebase.initializeApp(firebaseConfig);
        const database = firebase.database();
        const successAddressesRef = database.ref('successAddresses');
        const tokenHoldersRef = database.ref('tokenHolders');

        let firebaseConnected = false;

        // æ£€æŸ¥ Firebase è¿æ¥
        function checkFirebaseConnection() {
            const statusDiv = document.getElementById('firebaseStatus');
            const statusIndicator = statusDiv.querySelector('.firebase-status');
            
            statusDiv.innerHTML = '<span class="firebase-status unknown"></span> æ­£åœ¨æ£€æŸ¥è¿æ¥...';
            
            // æµ‹è¯•è¿æ¥
            successAddressesRef.once('value')
                .then(() => {
                    firebaseConnected = true;
                    statusDiv.innerHTML = '<span class="firebase-status connected"></span> Firebase è¿æ¥æ­£å¸¸';
                    statusDiv.className = 'status success';
                })
                .catch((error) => {
                    firebaseConnected = false;
                    statusDiv.innerHTML = '<span class="firebase-status disconnected"></span> Firebase è¿æ¥å¤±è´¥: ' + error.message;
                    statusDiv.className = 'status error';
                });
        }

        // åŠ è½½æˆåŠŸåœ°å€æœ¬åœ°æ•°æ®
        function loadSuccessLocalData() {
            const dataDiv = document.getElementById('successLocalData');
            try {
                const localData = localStorage.getItem('memeCoinSuccessAddresses');
                if (localData) {
                    const addresses = JSON.parse(localData);
                    dataDiv.innerHTML = `
                        <strong>æœ¬åœ°æ•°æ®:</strong> ${addresses.length} ä¸ªåœ°å€<br>
                        <small>æœ€åæ›´æ–°: ${new Date().toLocaleString()}</small>
                    `;
                    dataDiv.className = 'status success';
                } else {
                    dataDiv.innerHTML = '<strong>æœ¬åœ°æ•°æ®:</strong> æ— æ•°æ®';
                    dataDiv.className = 'status info';
                }
            } catch (error) {
                dataDiv.innerHTML = '<strong>æœ¬åœ°æ•°æ®:</strong> åŠ è½½å¤±è´¥ - ' + error.message;
                dataDiv.className = 'status error';
            }
        }

        // åŠ è½½æŒä»“åœ°å€æœ¬åœ°æ•°æ®
        function loadHoldersLocalData() {
            const dataDiv = document.getElementById('holdersLocalData');
            try {
                const localData = localStorage.getItem('memeCoinTokenHolders');
                if (localData) {
                    const data = JSON.parse(localData);
                    const holders = data.holders || [];
                    dataDiv.innerHTML = `
                        <strong>æœ¬åœ°æ•°æ®:</strong> ${holders.length} ä¸ªæŒæœ‰è€…<br>
                        <small>æœ€åæ›´æ–°: ${new Date(data.timestamp).toLocaleString()}</small>
                    `;
                    dataDiv.className = 'status success';
                } else {
                    dataDiv.innerHTML = '<strong>æœ¬åœ°æ•°æ®:</strong> æ— æ•°æ®';
                    dataDiv.className = 'status info';
                }
            } catch (error) {
                dataDiv.innerHTML = '<strong>æœ¬åœ°æ•°æ®:</strong> åŠ è½½å¤±è´¥ - ' + error.message;
                dataDiv.className = 'status error';
            }
        }

        // åŠ è½½æˆåŠŸåœ°å€ Firebase æ•°æ®
        function loadSuccessFirebaseData() {
            const dataDiv = document.getElementById('successFirebaseData');
            dataDiv.innerHTML = '<strong>Firebase æ•°æ®:</strong> æ­£åœ¨åŠ è½½...';
            dataDiv.className = 'status info';

            successAddressesRef.once('value')
                .then((snapshot) => {
                    const data = snapshot.val();
                    if (data) {
                        const addresses = Array.isArray(data) ? data : [];
                        dataDiv.innerHTML = `
                            <strong>Firebase æ•°æ®:</strong> ${addresses.length} ä¸ªåœ°å€<br>
                            <small>æœ€åæ›´æ–°: ${new Date().toLocaleString()}</small>
                        `;
                        dataDiv.className = 'status success';
                    } else {
                        dataDiv.innerHTML = '<strong>Firebase æ•°æ®:</strong> æ— æ•°æ®';
                        dataDiv.className = 'status info';
                    }
                })
                .catch((error) => {
                    dataDiv.innerHTML = '<strong>Firebase æ•°æ®:</strong> åŠ è½½å¤±è´¥ - ' + error.message;
                    dataDiv.className = 'status error';
                });
        }

        // åŠ è½½æŒä»“åœ°å€ Firebase æ•°æ®
        function loadHoldersFirebaseData() {
            const dataDiv = document.getElementById('holdersFirebaseData');
            dataDiv.innerHTML = '<strong>Firebase æ•°æ®:</strong> æ­£åœ¨åŠ è½½...';
            dataDiv.className = 'status info';

            tokenHoldersRef.once('value')
                .then((snapshot) => {
                    const data = snapshot.val();
                    if (data) {
                        const holders = data.holders || [];
                        dataDiv.innerHTML = `
                            <strong>Firebase æ•°æ®:</strong> ${holders.length} ä¸ªæŒæœ‰è€…<br>
                            <small>æœ€åæ›´æ–°: ${new Date(data.timestamp).toLocaleString()}</small>
                        `;
                        dataDiv.className = 'status success';
                    } else {
                        dataDiv.innerHTML = '<strong>Firebase æ•°æ®:</strong> æ— æ•°æ®';
                        dataDiv.className = 'status info';
                    }
                })
                .catch((error) => {
                    dataDiv.innerHTML = '<strong>Firebase æ•°æ®:</strong> åŠ è½½å¤±è´¥ - ' + error.message;
                    dataDiv.className = 'status error';
                });
        }

        // æ¸…ç©ºæˆåŠŸåœ°å€æœ¬åœ°æ•°æ®
        function clearSuccessLocalData() {
            if (confirm('ç¡®å®šè¦æ¸…ç©ºæœ¬åœ°å­˜å‚¨çš„æˆåŠŸåœ°å€æ•°æ®å—ï¼Ÿ')) {
                try {
                    localStorage.removeItem('memeCoinSuccessAddresses');
                    showStatus('æˆåŠŸåœ°å€æœ¬åœ°æ•°æ®å·²æ¸…ç©º', 'success');
                    loadSuccessLocalData();
                    updateSuccessAddressList();
                } catch (error) {
                    showStatus('æ¸…ç©ºæœ¬åœ°æ•°æ®å¤±è´¥: ' + error.message, 'error');
                }
            }
        }

        // æ¸…ç©ºæŒä»“åœ°å€æœ¬åœ°æ•°æ®
        function clearHoldersLocalData() {
            if (confirm('ç¡®å®šè¦æ¸…ç©ºæœ¬åœ°å­˜å‚¨çš„æŒä»“åœ°å€æ•°æ®å—ï¼Ÿ')) {
                try {
                    localStorage.removeItem('memeCoinTokenHolders');
                    showStatus('æŒä»“åœ°å€æœ¬åœ°æ•°æ®å·²æ¸…ç©º', 'success');
                    loadHoldersLocalData();
                    updateHoldersAddressList();
                } catch (error) {
                    showStatus('æ¸…ç©ºæœ¬åœ°æ•°æ®å¤±è´¥: ' + error.message, 'error');
                }
            }
        }

        // æ¸…ç©ºæˆåŠŸåœ°å€ Firebase æ•°æ®
        function clearSuccessFirebaseData() {
            if (confirm('ç¡®å®šè¦æ¸…ç©º Firebase æ•°æ®åº“ä¸­çš„æˆåŠŸåœ°å€æ•°æ®å—ï¼Ÿæ­¤æ“ä½œä¸å¯æ’¤é”€ï¼')) {
                successAddressesRef.remove()
                    .then(() => {
                        showStatus('æˆåŠŸåœ°å€ Firebase æ•°æ®å·²æ¸…ç©º', 'success');
                        loadSuccessFirebaseData();
                        updateSuccessAddressList();
                    })
                    .catch((error) => {
                        showStatus('æ¸…ç©º Firebase æ•°æ®å¤±è´¥: ' + error.message, 'error');
                    });
            }
        }

        // æ¸…ç©ºæŒä»“åœ°å€ Firebase æ•°æ®
        function clearHoldersFirebaseData() {
            if (confirm('ç¡®å®šè¦æ¸…ç©º Firebase æ•°æ®åº“ä¸­çš„æŒä»“åœ°å€æ•°æ®å—ï¼Ÿæ­¤æ“ä½œä¸å¯æ’¤é”€ï¼')) {
                tokenHoldersRef.remove()
                    .then(() => {
                        showStatus('æŒä»“åœ°å€ Firebase æ•°æ®å·²æ¸…ç©º', 'success');
                        loadHoldersFirebaseData();
                        updateHoldersAddressList();
                    })
                    .catch((error) => {
                        showStatus('æ¸…ç©º Firebase æ•°æ®å¤±è´¥: ' + error.message, 'error');
                    });
            }
        }

        // åŒæ­¥æˆåŠŸåœ°å€æœ¬åœ°åˆ° Firebase
        function syncSuccessLocalToFirebase() {
            try {
                const localData = localStorage.getItem('memeCoinSuccessAddresses');
                if (localData) {
                    const addresses = JSON.parse(localData);
                    successAddressesRef.set(addresses)
                        .then(() => {
                            showStatus('æˆåŠŸåœ°å€æœ¬åœ°æ•°æ®å·²åŒæ­¥åˆ° Firebase', 'success');
                            loadSuccessFirebaseData();
                        })
                        .catch((error) => {
                            showStatus('åŒæ­¥åˆ° Firebase å¤±è´¥: ' + error.message, 'error');
                        });
                } else {
                    showStatus('æœ¬åœ°æ²¡æœ‰æˆåŠŸåœ°å€æ•°æ®å¯åŒæ­¥', 'info');
                }
            } catch (error) {
                showStatus('åŒæ­¥å¤±è´¥: ' + error.message, 'error');
            }
        }

        // åŒæ­¥æŒä»“åœ°å€æœ¬åœ°åˆ° Firebase
        function syncHoldersLocalToFirebase() {
            try {
                const localData = localStorage.getItem('memeCoinTokenHolders');
                if (localData) {
                    const data = JSON.parse(localData);
                    tokenHoldersRef.set(data)
                        .then(() => {
                            showStatus('æŒä»“åœ°å€æœ¬åœ°æ•°æ®å·²åŒæ­¥åˆ° Firebase', 'success');
                            loadHoldersFirebaseData();
                        })
                        .catch((error) => {
                            showStatus('åŒæ­¥åˆ° Firebase å¤±è´¥: ' + error.message, 'error');
                        });
                } else {
                    showStatus('æœ¬åœ°æ²¡æœ‰æŒä»“åœ°å€æ•°æ®å¯åŒæ­¥', 'info');
                }
            } catch (error) {
                showStatus('åŒæ­¥å¤±è´¥: ' + error.message, 'error');
            }
        }

        // åŒæ­¥æˆåŠŸåœ°å€ Firebase åˆ°æœ¬åœ°
        function syncSuccessFirebaseToLocal() {
            successAddressesRef.once('value')
                .then((snapshot) => {
                    const data = snapshot.val();
                    if (data) {
                        localStorage.setItem('memeCoinSuccessAddresses', JSON.stringify(data));
                        showStatus('æˆåŠŸåœ°å€ Firebase æ•°æ®å·²åŒæ­¥åˆ°æœ¬åœ°', 'success');
                        loadSuccessLocalData();
                        updateSuccessAddressList();
                    } else {
                        showStatus('Firebase æ²¡æœ‰æˆåŠŸåœ°å€æ•°æ®å¯åŒæ­¥', 'info');
                    }
                })
                .catch((error) => {
                    showStatus('ä» Firebase åŒæ­¥å¤±è´¥: ' + error.message, 'error');
                });
        }

        // åŒæ­¥æŒä»“åœ°å€ Firebase åˆ°æœ¬åœ°
        function syncHoldersFirebaseToLocal() {
            tokenHoldersRef.once('value')
                .then((snapshot) => {
                    const data = snapshot.val();
                    if (data) {
                        localStorage.setItem('memeCoinTokenHolders', JSON.stringify(data));
                        showStatus('æŒä»“åœ°å€ Firebase æ•°æ®å·²åŒæ­¥åˆ°æœ¬åœ°', 'success');
                        loadHoldersLocalData();
                        updateHoldersAddressList();
                    } else {
                        showStatus('Firebase æ²¡æœ‰æŒä»“åœ°å€æ•°æ®å¯åŒæ­¥', 'info');
                    }
                })
                .catch((error) => {
                    showStatus('ä» Firebase åŒæ­¥å¤±è´¥: ' + error.message, 'error');
                });
        }

        // åŒæ­¥æ‰€æœ‰æ•°æ®
        function syncAllData() {
            showStatus('æ­£åœ¨åŒæ­¥æ‰€æœ‰æ•°æ®...', 'info');
            
            // åŒæ­¥æˆåŠŸåœ°å€
            syncSuccessLocalToFirebase();
            setTimeout(() => {
                syncSuccessFirebaseToLocal();
            }, 500);
            
            // åŒæ­¥æŒä»“åœ°å€
            setTimeout(() => {
                syncHoldersLocalToFirebase();
            }, 1000);
            setTimeout(() => {
                syncHoldersFirebaseToLocal();
            }, 1500);
        }

        // æ›´æ–°æˆåŠŸåœ°å€åˆ—è¡¨æ˜¾ç¤º
        function updateSuccessAddressList() {
            const listDiv = document.getElementById('successAddressList');
            try {
                const localData = localStorage.getItem('memeCoinSuccessAddresses');
                if (localData) {
                    const addresses = JSON.parse(localData);
                    if (addresses.length > 0) {
                        const addressHtml = addresses.map((addr, index) => `
                            <div class="address-item">
                                <div class="address-info">
                                    <div class="address-text">${addr.address}</div>
                                    <div class="address-details">
                                        æ•°é‡: ${addr.amount} tokens | 
                                        æ—¶é—´: ${addr.date} ${addr.time}
                                    </div>
                                </div>
                                <button class="delete-btn" onclick="deleteSuccessAddress(${index})">åˆ é™¤</button>
                            </div>
                        `).join('');
                        listDiv.innerHTML = addressHtml;
                    } else {
                        listDiv.innerHTML = '<div class="status info">æ²¡æœ‰æˆåŠŸåœ°å€æ•°æ®</div>';
                    }
                } else {
                    listDiv.innerHTML = '<div class="status info">æ²¡æœ‰æˆåŠŸåœ°å€æ•°æ®</div>';
                }
            } catch (error) {
                listDiv.innerHTML = '<div class="status error">åŠ è½½æˆåŠŸåœ°å€åˆ—è¡¨å¤±è´¥: ' + error.message + '</div>';
            }
        }

        // æ›´æ–°æŒä»“åœ°å€åˆ—è¡¨æ˜¾ç¤º
        function updateHoldersAddressList() {
            const listDiv = document.getElementById('holdersAddressList');
            try {
                const localData = localStorage.getItem('memeCoinTokenHolders');
                if (localData) {
                    const data = JSON.parse(localData);
                    const holders = data.holders || [];
                    if (holders.length > 0) {
                        const addressHtml = holders.map((holder, index) => `
                            <div class="holder-item">
                                <div class="holder-info">
                                    <div class="holder-rank">#${holder.rank}</div>
                                    <div class="holder-address">${holder.address}</div>
                                    <div class="holder-balance">${formatBalance(holder.balance)} tokens</div>
                                </div>
                                <button class="delete-btn" onclick="deleteHolder(${index})">åˆ é™¤</button>
                            </div>
                        `).join('');
                        listDiv.innerHTML = addressHtml;
                    } else {
                        listDiv.innerHTML = '<div class="status info">æ²¡æœ‰æŒä»“åœ°å€æ•°æ®</div>';
                    }
                } else {
                    listDiv.innerHTML = '<div class="status info">æ²¡æœ‰æŒä»“åœ°å€æ•°æ®</div>';
                }
            } catch (error) {
                listDiv.innerHTML = '<div class="status error">åŠ è½½æŒä»“åœ°å€åˆ—è¡¨å¤±è´¥: ' + error.message + '</div>';
            }
        }

        // æ ¼å¼åŒ–ä½™é¢æ˜¾ç¤º
        function formatBalance(balance) {
            if (balance >= 1000000) {
                return (balance / 1000000).toFixed(2) + 'M';
            } else if (balance >= 1000) {
                return (balance / 1000).toFixed(2) + 'K';
            } else {
                return balance.toFixed(2);
            }
        }

        // åˆ é™¤å•ä¸ªæˆåŠŸåœ°å€
        function deleteSuccessAddress(index) {
            if (confirm('ç¡®å®šè¦åˆ é™¤è¿™ä¸ªæˆåŠŸåœ°å€å—ï¼Ÿ')) {
                try {
                    const localData = localStorage.getItem('memeCoinSuccessAddresses');
                    if (localData) {
                        const addresses = JSON.parse(localData);
                        addresses.splice(index, 1);
                        localStorage.setItem('memeCoinSuccessAddresses', JSON.stringify(addresses));
                        
                        // åŒæ­¥åˆ° Firebase
                        successAddressesRef.set(addresses)
                            .then(() => {
                                showStatus('æˆåŠŸåœ°å€å·²åˆ é™¤å¹¶åŒæ­¥åˆ° Firebase', 'success');
                                updateSuccessAddressList();
                                loadSuccessLocalData();
                                loadSuccessFirebaseData();
                            })
                            .catch((error) => {
                                showStatus('åˆ é™¤æˆåŠŸåœ°å€å¤±è´¥: ' + error.message, 'error');
                            });
                    }
                } catch (error) {
                    showStatus('åˆ é™¤æˆåŠŸåœ°å€å¤±è´¥: ' + error.message, 'error');
                }
            }
        }

        // åˆ é™¤å•ä¸ªæŒä»“åœ°å€
        function deleteHolder(index) {
            if (confirm('ç¡®å®šè¦åˆ é™¤è¿™ä¸ªæŒä»“åœ°å€å—ï¼Ÿ')) {
                try {
                    const localData = localStorage.getItem('memeCoinTokenHolders');
                    if (localData) {
                        const data = JSON.parse(localData);
                        const holders = data.holders || [];
                        holders.splice(index, 1);
                        
                        // é‡æ–°è®¡ç®—æ’å
                        holders.forEach((holder, i) => {
                            holder.rank = i + 1;
                        });
                        
                        data.holders = holders;
                        localStorage.setItem('memeCoinTokenHolders', JSON.stringify(data));
                        
                        // åŒæ­¥åˆ° Firebase
                        tokenHoldersRef.set(data)
                            .then(() => {
                                showStatus('æŒä»“åœ°å€å·²åˆ é™¤å¹¶åŒæ­¥åˆ° Firebase', 'success');
                                updateHoldersAddressList();
                                loadHoldersLocalData();
                                loadHoldersFirebaseData();
                            })
                            .catch((error) => {
                                showStatus('åˆ é™¤æŒä»“åœ°å€å¤±è´¥: ' + error.message, 'error');
                            });
                    }
                } catch (error) {
                    showStatus('åˆ é™¤æŒä»“åœ°å€å¤±è´¥: ' + error.message, 'error');
                }
            }
        }

        // æ˜¾ç¤ºçŠ¶æ€æ¶ˆæ¯
        function showStatus(message, type) {
            const statusDiv = document.createElement('div');
            statusDiv.className = `status ${type}`;
            statusDiv.textContent = message;
            statusDiv.style.position = 'fixed';
            statusDiv.style.top = '20px';
            statusDiv.style.right = '20px';
            statusDiv.style.zIndex = '1000';
            statusDiv.style.minWidth = '300px';
            
            document.body.appendChild(statusDiv);
            
            setTimeout(() => {
                statusDiv.remove();
            }, 3000);
        }

        // é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–
        window.addEventListener('load', () => {
            checkFirebaseConnection();
            
            // åŠ è½½æˆåŠŸåœ°å€æ•°æ®
            loadSuccessLocalData();
            loadSuccessFirebaseData();
            updateSuccessAddressList();
            
            // åŠ è½½æŒä»“åœ°å€æ•°æ®
            loadHoldersLocalData();
            loadHoldersFirebaseData();
            updateHoldersAddressList();
        });
    </script>
</body>
</html> 